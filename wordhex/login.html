<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WordHex – Sign In with Discord</title>
  <style>
    :root {
      color-scheme: dark;
      --bg: #090b12;
      --panel: rgba(20, 26, 44, 0.85);
      --accent: #8c71ff;
      --accent-strong: #b891ff;
      --text: #f8f9ff;
      --muted: #b5b9d8;
      --discord-blue: #5865f2;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      min-height: 100vh;
      font-family: "Inter", "Segoe UI", system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at top, rgba(140, 113, 255, 0.25), transparent 55%),
        radial-gradient(circle at bottom, rgba(88, 241, 255, 0.18), transparent 45%),
        var(--bg);
      color: var(--text);
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem 1.5rem;
    }

    .container {
      width: 100%;
      max-width: 500px;
      text-align: center;
      animation: slideUp 0.6s ease-out;
    }

    header {
      margin-bottom: 2.5rem;
    }

    h1 {
      font-size: clamp(2rem, 5vw, 2.5rem);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      margin: 0 0 0.5rem;
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 1rem;
      color: var(--muted);
      margin: 0;
      font-weight: 300;
    }

    .divider {
      width: 60px;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
      margin: 0 auto 2rem;
    }

    .login-box {
      background: var(--panel);
      border: 1px solid rgba(140, 113, 255, 0.2);
      border-radius: 16px;
      padding: 2.5rem 2rem;
      margin-bottom: 2rem;
    }

    .login-box h2 {
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      margin: 0 0 1.5rem;
      color: var(--muted);
    }

    .discord-button {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      width: 100%;
      padding: 1.2rem 1.5rem;
      background: var(--discord-blue);
      border: none;
      border-radius: 10px;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
    }

    .discord-button:hover {
      background: #4752c4;
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(88, 101, 242, 0.4);
    }

    .discord-button:active {
      transform: translateY(0);
    }

    .discord-icon {
      width: 20px;
      height: 20px;
    }

    .info {
      background: rgba(140, 113, 255, 0.1);
      border: 1px solid rgba(140, 113, 255, 0.2);
      border-radius: 10px;
      padding: 1.2rem;
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
      color: var(--muted);
      line-height: 1.6;
    }

    .info strong {
      color: var(--text);
    }

    .footer {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.3);
    }

    .footer a {
      color: var(--accent);
      text-decoration: none;
      transition: color 0.3s;
    }

    .footer a:hover {
      color: var(--accent-strong);
      text-decoration: underline;
    }

    .error {
      background: rgba(255, 102, 140, 0.1);
      border: 1px solid rgba(255, 102, 140, 0.3);
      color: #fca5a5;
      padding: 1rem;
      border-radius: 10px;
      margin-bottom: 1.5rem;
      display: none;
    }

    .error.show {
      display: block;
    }

    .loading {
      display: none;
      text-align: center;
      color: var(--muted);
    }

    .loading.show {
      display: block;
    }

    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(140, 113, 255, 0.2);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin-right: 10px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 600px) {
      body {
        padding: 1.5rem 1rem;
      }

      .login-box {
        padding: 1.5rem 1.2rem;
      }

      h1 {
        font-size: 1.8rem;
      }

      .discord-button {
        padding: 1rem 1.2rem;
        font-size: 0.95rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>WordHex</h1>
      <p class="subtitle">Sign In with Discord</p>
    </header>

    <div class="divider"></div>

    <div class="error" id="error"></div>
    <div class="loading" id="loading">
      <div class="spinner"></div>
      Connecting to Discord...
    </div>

    <div class="login-box" id="loginBox">
      <h2>Sign In</h2>
      <button class="discord-button" id="discordLoginBtn">
        <svg class="discord-icon" viewBox="0 0 127.14 96.36" xmlns="http://www.w3.org/2000/svg">
          <path d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0A105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a77.15,77.15,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.22,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60.55,31,53.88s5-11.8,11.43-11.8S53.89,47.21,53.89,53.88,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60.55,73.25,53.88s5-11.8,11.44-11.8S96.11,47.21,96.11,53.88,91.06,65.69,84.69,65.69Z" fill="white"/>
        </svg>
        Sign in with Discord
      </button>

      <div class="info">
        <strong>Privacy & Permissions:</strong><br>
        We only access your Discord username, avatar, and user ID. Your stats are stored securely in our database.
      </div>
    </div>

    <p class="footer">
      Don't have Discord? <a href="https://discord.com/download" target="_blank">Download Discord</a><br>
      <a href="/wordhex/">← Back to Menu</a>
    </p>
  </div>

  <script>
    const CLIENT_ID = '1440392506553405580';
    const REDIRECT_URI = 'https://dussey.dev/.netlify/functions/discord-auth';

    const discordLoginBtn = document.getElementById('discordLoginBtn');
    const errorDiv = document.getElementById('error');
    const loadingDiv = document.getElementById('loading');
    const loginBox = document.getElementById('loginBox');

    function showError(message) {
      errorDiv.textContent = message;
      errorDiv.classList.add('show');
      loadingDiv.classList.remove('show');
      loginBox.style.display = 'block';
    }

    function startLogin() {
      loadingDiv.classList.add('show');
      loginBox.style.display = 'none';

      const scopes = 'identify+email';
      const discordAuthUrl = `https://discord.com/oauth2/authorize?client_id=${CLIENT_ID}&response_type=code&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&scope=${scopes}`;

      window.location.href = discordAuthUrl;
    }

    discordLoginBtn.addEventListener('click', startLogin);

    // Check for auth error in URL
    const params = new URLSearchParams(window.location.search);
    if (params.has('error')) {
      showError(`Authentication failed: ${params.get('error_description') || 'Unknown error'}`);
    }
  </script>
</body>
</html>
